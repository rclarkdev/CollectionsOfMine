{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\Users\\\\rclar\\\\source\\\\repos\\\\CollectionsOfMine\\\\ClientApp\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from \"@angular/core\";\nimport { ModelListService } from \"../../services/model-list.service\";\nimport { CommonService } from \"../../services/common.service\";\nlet ItemListComponent = class ItemListComponent {\n  constructor(router, http, activeRoute, dataTableService, modalService) {\n    var _this = this;\n    this.router = router;\n    this.http = http;\n    this.activeRoute = activeRoute;\n    this.dataTableService = dataTableService;\n    this.modalService = modalService;\n    this.viewItems = [];\n    this.showTable = true;\n    this.editItem = true;\n    this.edit = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (content, id) {\n        _this.editItem = true;\n        _this.itemId = id;\n        _this.open(content);\n      });\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    this.delete = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(function* (id) {\n        if (confirm(\"Are you sure?\")) {\n          yield _this.itemService.delete(id);\n          location.reload();\n        }\n      });\n      return function (_x3) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    // TODO: put in a helper or extension\n    this.getURLParameter = name => {\n      return decodeURIComponent((new RegExp(\"[?|&]\" + name + \"=\" + \"([^&;]+?)(&|#|;|$)\").exec(location.search) || [null, \"\"])[1].replace(/\\+/g, \"%20\")) || null;\n    };\n    this.itemService = new CommonService(\"items\", http);\n    this.collectionService = new CommonService(\"collections\", http);\n    this.modalOptions = {\n      size: 'lg'\n    };\n  }\n  open(content) {\n    if (!this.editItem) this.itemId = null;\n    this.modalService.open(content, this.modalOptions).result.then(result => {}, reason => {});\n    this.editItem = false;\n  }\n  close() {\n    this.modalService.dismissAll();\n  }\n  ngOnInit() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      debugger;\n      let collectionName = _this2.getURLParameter(\"collection\");\n      //const that = this;\n      if (_this2.activeRoute.routeConfig.path === \"items\") {\n        _this2.itemsTitle = \"Items\";\n        yield _this2.itemService.getAll().then(function (items) {\n          var _this3 = this;\n          this.itemService.typesObservable.subscribe( /*#__PURE__*/function () {\n            var _ref3 = _asyncToGenerator(function* (items) {\n              _this3.items = items;\n              _this3.dataTableService.setDtTrigger(items);\n              _this3.items.forEach( /*#__PURE__*/function () {\n                var _ref4 = _asyncToGenerator(function* (item) {\n                  let viewItem = {\n                    Id: item[\"id\"],\n                    Name: item[\"name\"],\n                    Description: item[\"description\"],\n                    IsDeleted: item[\"isDeleted\"],\n                    CreatedOn: item[\"createdOn\"],\n                    Source: item[\"source\"]\n                  };\n                  this.viewItems.push(viewItem);\n                  if (collectionName) {\n                    this.viewItems = this.viewItems.filter(function (viewItem) {\n                      return viewItem[\"collections\"][0].collectionViewModel.name.toLocaleLowerCase() === collectionName;\n                    });\n                  }\n                });\n                return function (_x5) {\n                  return _ref4.apply(this, arguments);\n                };\n              }());\n            });\n            return function (_x4) {\n              return _ref3.apply(this, arguments);\n            };\n          }());\n          this.itemService.setTypes(items);\n        });\n      } else {\n        _this2.showTable = false;\n        _this2.modelListService = new ModelListService(\"items\", _this2.http);\n        yield _this2.activeRoute.paramMap.subscribe( /*#__PURE__*/function () {\n          var _ref5 = _asyncToGenerator(function* (params) {\n            _this2.viewItems.length = 0;\n            _this2.collectionId = params.get(\"id\");\n          });\n          return function (_x6) {\n            return _ref5.apply(this, arguments);\n          };\n        }());\n        if (_this2.collectionId) {\n          _this2.collection = yield _this2.collectionService.getById(_this2.collectionId);\n          let items = _this2.collection[\"items\"];\n          _this2.itemsTitle = _this2.collection[\"name\"];\n          _this2.areaId = _this2.collection[\"area\"][\"id\"];\n          items.forEach(function (item) {\n            let viewItem = {\n              id: item[\"id\"],\n              name: item[\"name\"],\n              description: item[\"description\"]\n            };\n            this.viewItems.push(viewItem);\n          });\n        }\n      }\n    })();\n  }\n};\nItemListComponent = __decorate([Component({\n  selector: \"app-item-list\",\n  templateUrl: \"./item-list.component.html\",\n  styleUrls: [\"./item-list.component.css\"]\n})], ItemListComponent);\nexport { ItemListComponent };","map":{"version":3,"names":["__decorate","Component","ModelListService","CommonService","ItemListComponent","constructor","router","http","activeRoute","dataTableService","modalService","viewItems","showTable","editItem","edit","content","id","itemId","open","delete","confirm","itemService","location","reload","getURLParameter","name","decodeURIComponent","RegExp","exec","search","replace","collectionService","modalOptions","size","result","then","reason","close","dismissAll","ngOnInit","collectionName","routeConfig","path","itemsTitle","getAll","items","typesObservable","subscribe","setDtTrigger","forEach","item","viewItem","Id","Name","Description","IsDeleted","CreatedOn","Source","push","filter","collectionViewModel","toLocaleLowerCase","setTypes","modelListService","paramMap","params","length","collectionId","get","collection","getById","areaId","description","selector","templateUrl","styleUrls"],"sources":["C:/Users/rclar/source/repos/CollectionsOfMine/ClientApp/src/app/item/list/item-list.component.ts"],"sourcesContent":["import { __decorate } from \"tslib\";\r\nimport { Component } from \"@angular/core\";\r\nimport { ModelListService } from \"../../services/model-list.service\";\r\nimport { CommonService } from \"../../services/common.service\";\r\nlet ItemListComponent = class ItemListComponent {\r\n    constructor(router, http, activeRoute, dataTableService, modalService) {\r\n        this.router = router;\r\n        this.http = http;\r\n        this.activeRoute = activeRoute;\r\n        this.dataTableService = dataTableService;\r\n        this.modalService = modalService;\r\n        this.viewItems = [];\r\n        this.showTable = true;\r\n        this.editItem = true;\r\n        this.edit = async (content, id) => {\r\n            this.editItem = true;\r\n            this.itemId = id;\r\n            this.open(content);\r\n        };\r\n        this.delete = async (id) => {\r\n            if (confirm(\"Are you sure?\")) {\r\n                await this.itemService.delete(id);\r\n                location.reload();\r\n            }\r\n        };\r\n        // TODO: put in a helper or extension\r\n        this.getURLParameter = (name) => {\r\n            return (decodeURIComponent((new RegExp(\"[?|&]\" + name + \"=\" + \"([^&;]+?)(&|#|;|$)\").exec(location.search) || [null, \"\"])[1].replace(/\\+/g, \"%20\")) || null);\r\n        };\r\n        this.itemService = new CommonService(\"items\", http);\r\n        this.collectionService = new CommonService(\"collections\", http);\r\n        this.modalOptions = {\r\n            size: 'lg'\r\n        };\r\n    }\r\n    open(content) {\r\n        if (!this.editItem)\r\n            this.itemId = null;\r\n        this.modalService.open(content, this.modalOptions).result.then((result) => { }, (reason) => { });\r\n        this.editItem = false;\r\n    }\r\n    close() {\r\n        this.modalService.dismissAll();\r\n    }\r\n    async ngOnInit() {\r\n        debugger;\r\n        let collectionName = this.getURLParameter(\"collection\");\r\n        //const that = this;\r\n        if (this.activeRoute.routeConfig.path === \"items\") {\r\n            this.itemsTitle = \"Items\";\r\n            await this.itemService.getAll().then(function (items) {\r\n                this.itemService.typesObservable.subscribe(async (items) => {\r\n                    this.items = items;\r\n                    this.dataTableService.setDtTrigger(items);\r\n                    this.items.forEach(async function (item) {\r\n                        let viewItem = {\r\n                            Id: item[\"id\"],\r\n                            Name: item[\"name\"],\r\n                            Description: item[\"description\"],\r\n                            IsDeleted: item[\"isDeleted\"],\r\n                            CreatedOn: item[\"createdOn\"],\r\n                            Source: item[\"source\"],\r\n                        };\r\n                        this.viewItems.push(viewItem);\r\n                        if (collectionName) {\r\n                            this.viewItems = this.viewItems.filter(function (viewItem) {\r\n                                return (viewItem[\"collections\"][0].collectionViewModel.name.toLocaleLowerCase() === collectionName);\r\n                            });\r\n                        }\r\n                    });\r\n                });\r\n                this.itemService.setTypes(items);\r\n            });\r\n        }\r\n        else {\r\n            this.showTable = false;\r\n            this.modelListService = new ModelListService(\"items\", this.http);\r\n            await this.activeRoute.paramMap.subscribe(async (params) => {\r\n                this.viewItems.length = 0;\r\n                this.collectionId = params.get(\"id\");\r\n            });\r\n            if (this.collectionId) {\r\n                this.collection = await this.collectionService.getById(this.collectionId);\r\n                let items = this.collection[\"items\"];\r\n                this.itemsTitle = this.collection[\"name\"];\r\n                this.areaId = this.collection[\"area\"][\"id\"];\r\n                items.forEach(function (item) {\r\n                    let viewItem = {\r\n                        id: item[\"id\"],\r\n                        name: item[\"name\"],\r\n                        description: item[\"description\"],\r\n                    };\r\n                    this.viewItems.push(viewItem);\r\n                });\r\n            }\r\n        }\r\n    }\r\n};\r\nItemListComponent = __decorate([\r\n    Component({\r\n        selector: \"app-item-list\",\r\n        templateUrl: \"./item-list.component.html\",\r\n        styleUrls: [\"./item-list.component.css\"],\r\n    })\r\n], ItemListComponent);\r\nexport { ItemListComponent };\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}