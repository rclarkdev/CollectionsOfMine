{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\Users\\\\rclar\\\\source\\\\repos\\\\CollectionsOfMine\\\\ClientApp\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { CommonService } from '../../services/common.service';\nlet CollectionFormComponent = class CollectionFormComponent {\n  constructor(http, uploadService, modalService) {\n    var _this = this;\n    this.http = http;\n    this.uploadService = uploadService;\n    this.modalService = modalService;\n    this.emitRefreshCollections = new EventEmitter();\n    this.selectedContentTypes = [];\n    this.createOrUpdate = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (collection) {\n        const contentTypeBtns = document.getElementsByClassName(\"content-btn\");\n        let that = _this;\n        if (contentTypeBtns) {\n          Array.from(contentTypeBtns).forEach(function (element) {\n            if (element.classList.contains(\"selected\")) {\n              that.selectedContentTypes.push(that.contentTypes.find(t => t['name'] === element['defaultValue']));\n            }\n          });\n          if (_this.selectedContentTypes) {\n            collection.ContentTypes = _this.selectedContentTypes;\n          }\n        }\n        yield (collection[\"id\"] ? _this.collectionsService.update(collection) : _this.collectionsService.create(collection)).then(() => {\n          _this.modalService.dismissAll();\n          _this.emitRefreshCollections.emit(true);\n        });\n      });\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    this.collectionsService = new CommonService(\"collections\", http);\n    this.areasService = new CommonService(\"areas\", http);\n    this.contentTypesService = new CommonService(\"contentTypes\", http);\n  }\n  ngOnInit() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.areaViewModels = yield _this2.areasService.getAll();\n      _this2.contentTypes = yield _this2.contentTypesService.getAll();\n    })();\n  }\n  ngAfterViewChecked() {\n    if (!this.clickHandlersSet) {\n      const btnDoc = document.getElementsByClassName('btn-Documents')[0];\n      const btnPic = document.getElementsByClassName('btn-Pictures')[0];\n      const btnVid = document.getElementsByClassName('btn-Videos')[0];\n      const btnCus = document.getElementsByClassName('btn-Custom')[0];\n      if (btnVid && btnPic && btnDoc && btnCus) {\n        this.handleClick(btnDoc);\n        this.handleClick(btnPic);\n        this.handleClick(btnVid);\n        this.handleClick(btnCus);\n        this.clickHandlersSet = true;\n      }\n    }\n  }\n  handleClick(el) {\n    el.addEventListener('click', function onClick(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      console.log(event.target);\n      const backgroundColor = event.target.style.backgroundColor;\n      if (backgroundColor !== 'lightgreen') {\n        event.target.style.backgroundColor = 'lightgreen';\n        el.classList.add('selected');\n      } else {\n        event.target.style.backgroundColor = '#DEDEDE';\n        el.classList.remove('selected');\n      }\n    });\n  }\n  onSubmit(data) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      var _a;\n      _this3.collection = data.value;\n      const input = document.querySelector(\"input[type=file]\");\n      if (input) _this3.files = input.files;\n      let fileId = 0;\n      if ((_a = _this3.files) === null || _a === void 0 ? void 0 : _a.length) {\n        const fileToUpload = _this3.files[0];\n        yield _this3.uploadService.uploadFile(fileToUpload).then( /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(function* (response) {\n            if (response && response.body) {\n              fileId = response.body;\n            }\n          });\n          return function (_x2) {\n            return _ref2.apply(this, arguments);\n          };\n        }());\n      }\n      _this3.collection.FileId = fileId;\n      _this3.collection.Area = {\n        Base: {\n          Id: data.value.selectedArea\n        }\n      };\n      _this3.createOrUpdate(_this3.collection);\n    })();\n  }\n};\n__decorate([Output()], CollectionFormComponent.prototype, \"emitRefreshCollections\", void 0);\n__decorate([Input()], CollectionFormComponent.prototype, \"selectedArea\", void 0);\n__decorate([Input()], CollectionFormComponent.prototype, \"collection\", void 0);\nCollectionFormComponent = __decorate([Component({\n  selector: 'app-collection-form',\n  templateUrl: './collection-form.component.html',\n  styleUrls: ['./collection-form.component.css']\n})], CollectionFormComponent);\nexport { CollectionFormComponent };","map":{"version":3,"names":["__decorate","Component","EventEmitter","Input","Output","CommonService","CollectionFormComponent","constructor","http","uploadService","modalService","emitRefreshCollections","selectedContentTypes","createOrUpdate","collection","contentTypeBtns","document","getElementsByClassName","that","Array","from","forEach","element","classList","contains","push","contentTypes","find","t","ContentTypes","collectionsService","update","create","then","dismissAll","emit","areasService","contentTypesService","ngOnInit","areaViewModels","getAll","ngAfterViewChecked","clickHandlersSet","btnDoc","btnPic","btnVid","btnCus","handleClick","el","addEventListener","onClick","event","preventDefault","stopPropagation","console","log","target","backgroundColor","style","add","remove","onSubmit","data","_a","value","input","querySelector","files","fileId","length","fileToUpload","uploadFile","response","body","FileId","Area","Base","Id","selectedArea","prototype","selector","templateUrl","styleUrls"],"sources":["C:/Users/rclar/source/repos/CollectionsOfMine/ClientApp/src/app/collection/form/collection-form.component.ts"],"sourcesContent":["import { __decorate } from \"tslib\";\r\nimport { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { CommonService } from '../../services/common.service';\r\nlet CollectionFormComponent = class CollectionFormComponent {\r\n    constructor(http, uploadService, modalService) {\r\n        this.http = http;\r\n        this.uploadService = uploadService;\r\n        this.modalService = modalService;\r\n        this.emitRefreshCollections = new EventEmitter();\r\n        this.selectedContentTypes = [];\r\n        this.createOrUpdate = async (collection) => {\r\n            const contentTypeBtns = document.getElementsByClassName(\"content-btn\");\r\n            let that = this;\r\n            if (contentTypeBtns) {\r\n                Array.from(contentTypeBtns).forEach(function (element) {\r\n                    if (element.classList.contains(\"selected\")) {\r\n                        that.selectedContentTypes.push(that.contentTypes.find(t => t['name'] === element['defaultValue']));\r\n                    }\r\n                });\r\n                if (this.selectedContentTypes) {\r\n                    collection.ContentTypes = this.selectedContentTypes;\r\n                }\r\n            }\r\n            await (collection[\"id\"]\r\n                ? this.collectionsService.update(collection)\r\n                : this.collectionsService.create(collection)).then(() => {\r\n                this.modalService.dismissAll();\r\n                this.emitRefreshCollections.emit(true);\r\n            });\r\n        };\r\n        this.collectionsService = new CommonService(\"collections\", http);\r\n        this.areasService = new CommonService(\"areas\", http);\r\n        this.contentTypesService = new CommonService(\"contentTypes\", http);\r\n    }\r\n    async ngOnInit() {\r\n        this.areaViewModels = await this.areasService.getAll();\r\n        this.contentTypes = await this.contentTypesService.getAll();\r\n    }\r\n    ngAfterViewChecked() {\r\n        if (!this.clickHandlersSet) {\r\n            const btnDoc = document.getElementsByClassName('btn-Documents')[0];\r\n            const btnPic = document.getElementsByClassName('btn-Pictures')[0];\r\n            const btnVid = document.getElementsByClassName('btn-Videos')[0];\r\n            const btnCus = document.getElementsByClassName('btn-Custom')[0];\r\n            if (btnVid && btnPic && btnDoc && btnCus) {\r\n                this.handleClick(btnDoc);\r\n                this.handleClick(btnPic);\r\n                this.handleClick(btnVid);\r\n                this.handleClick(btnCus);\r\n                this.clickHandlersSet = true;\r\n            }\r\n        }\r\n    }\r\n    handleClick(el) {\r\n        el.addEventListener('click', function onClick(event) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            console.log(event.target);\r\n            const backgroundColor = event.target.style.backgroundColor;\r\n            if (backgroundColor !== 'lightgreen') {\r\n                event.target.style.backgroundColor = 'lightgreen';\r\n                el.classList.add('selected');\r\n            }\r\n            else {\r\n                event.target.style.backgroundColor = '#DEDEDE';\r\n                el.classList.remove('selected');\r\n            }\r\n        });\r\n    }\r\n    async onSubmit(data) {\r\n        var _a;\r\n        this.collection = data.value;\r\n        const input = document.querySelector(\"input[type=file]\");\r\n        if (input)\r\n            this.files = input.files;\r\n        let fileId = 0;\r\n        if ((_a = this.files) === null || _a === void 0 ? void 0 : _a.length) {\r\n            const fileToUpload = this.files[0];\r\n            await this.uploadService\r\n                .uploadFile(fileToUpload)\r\n                .then(async (response) => {\r\n                if (response && response.body) {\r\n                    fileId = response.body;\r\n                }\r\n            });\r\n        }\r\n        this.collection.FileId = fileId;\r\n        this.collection.Area = {\r\n            Base: { Id: data.value.selectedArea }\r\n        };\r\n        this.createOrUpdate(this.collection);\r\n    }\r\n};\r\n__decorate([\r\n    Output()\r\n], CollectionFormComponent.prototype, \"emitRefreshCollections\", void 0);\r\n__decorate([\r\n    Input()\r\n], CollectionFormComponent.prototype, \"selectedArea\", void 0);\r\n__decorate([\r\n    Input()\r\n], CollectionFormComponent.prototype, \"collection\", void 0);\r\nCollectionFormComponent = __decorate([\r\n    Component({\r\n        selector: 'app-collection-form',\r\n        templateUrl: './collection-form.component.html',\r\n        styleUrls: ['./collection-form.component.css']\r\n    })\r\n], CollectionFormComponent);\r\nexport { CollectionFormComponent };\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}